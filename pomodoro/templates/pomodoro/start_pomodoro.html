{% extends "base.html" %}
{% load static %}
{% block title %}Pomodoro Başlat{% endblock %}

{% block content %}
<style>
    body {
        font-family: 'Sora', sans-serif;
        margin: 0;
        padding: 0;
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: start;
        background: linear-gradient(to right, #ffdee9, #b5fffc);
        transition: background 0.5s ease;
    }

    body.dark-mode {
        background: linear-gradient(to right, #1f0036, #000000);
    }

    .container {
        margin-top: 80px;
        background: linear-gradient(135deg, #ffffff, #d1b4ff);
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        color: #333;
    }
    .dark-mode .container {
        background: linear-gradient(135deg, #2d004d, #1c1c1c);
        color: #fff;
    }
    .btn {
        font-family: 'Sora', sans-serif;
        padding: 10px 50px;
        border-radius: 10px;
        font-size: 20px;
        cursor: pointer;
    }
    .progress {
        width: 100%;
        background-color: #e3ebfd;
        border-radius: 10px;
        overflow: hidden;
        height: 20px;
    }
    .progress-bar {
        height: 100%;
        background-color: #6a00f4;
        width: 0%;
        transition: width 0.3s;
    }
    .history {
        margin-bottom: 80px;
    }
</style>

<img src="{% static 'images/focuzon_logo_.png' %}" alt="Focuzon Logo" class="focuzon-logo">

<div class="container">
    <h2 class="section-title">Pomodoro Sayaç</h2>
    <p class="sub-text">Seçtiğin süre boyunca odaklan ve üretkenliğini artır! </p>

    <form method="POST" id="pomodoro-form">
        {% csrf_token %}
        <div class="form-group">
            <label for="id_duration" class="fw-bold">Çalışma Süresi Seç:</label>
            <select id="id_duration" class="form-control">
                <option value="">-- Süre Seç --</option>
                <option value="5">5 Dakika</option>
                <option value="10">10 Dakika</option>
                <option value="15">15 Dakika</option>
                <option value="20">20 Dakika</option>
                <option value="25">25 Dakika</option>
                <option value="30">30 Dakika</option>
            </select>
        </div>
        <button type="button" class="btn btn-success mt-3 w-100" id="startBtn">🚀 Başlat</button>
    </form>

    <h2 id="timer" class="fw-bold mt-4">00:00</h2>

    <div class="controls">
        <button id="pauseBtn" class="btn btn-warning w-100 mt-2" style="display: none;">⏸ Duraklat</button>
        <button id="resumeBtn" class="btn btn-primary w-100 mt-2" style="display: none;">▶ Devam Et</button>
        <button id="completeBtn" class="btn btn-danger w-100 mt-2" style="display: none;">🛑 Çalışmayı Bitir</button>
    </div>

    <div class="progress mt-3">
       <div id="progressBar" class="progress-bar" role="progressbar"></div>
    </div>
    <div id="successMessage" style="display:none; margin-top:20px; font-size:18px; color:#6a00f4;">
        🎉 Harika! Odaklanma süreni tamamladın!
    </div>

    <div class="history text-center mt-5">
        <h3>📜 Geçmiş Oturumlar</h3>
        <ul>
            {% for session in past_sessions %}
                <li>✅ {{ session.start_time|date:"d M Y H:i" }} - {{ session.formatted_duration }}</li>
            {% empty %}
                <li>Henüz kayıtlı oturum yok.</li>
            {% endfor %}
        </ul>
        <button id="clearSessions" class="btn btn-danger mt-3">Geçmiş Oturumları Sil</button>
        <a href="{% url 'dashboard' %}" class="btn btn-primary mt-4">📊 Dashboard'a Git</a>
    </div>
</div>

<input type="hidden" id="session_id" value="">

<script>
// JS kodları (start, pause, resume, complete, progress bar, dark mode) önceki haliyle çalışıyor, dokunulmadı.
</script>
{% endblock %}
